<div class=" w-full  ">

    <div class="mt-20  flex flex-col items-center    ">

        <form class="mb-6 fixed w-1/2 z-50 overflow-hidden p-4 bg-white rounded-lg shadow-md border border-gray-200">
            <label class="block text-sm font-medium text-gray-700 mb-2">Filter Todos</label>
            <input type="text" name="searchTerm" [(ngModel)]="searchTerm" placeholder="Searching todos ..."
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 
                focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
        </form>

        <div class="mb-6 top-48 fixed w-1/8 z-50 overflow-hidden  bg-white rounded-lg shadow-md border border-gray-200">
            <button class="w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white font-medium text-sm rounded-lg 
            transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-300 
            shadow-sm hover:shadow-md active:transform active:scale-95" (click)="toggleTodoForm()">
                Add Todos
            </button>
        </div>


        <!-- Todo Form Modal -->
        @if (showTodoForm) {
        <div class="fixed inset-0  bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-md mx-4">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Add New Todo</h2>

                <form [formGroup]="todoForm" (ngSubmit)="onSubmit()">

                    <!-- Title Field -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Title *</label>
                        <input type="text" formControlName="title" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm 
                               focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Enter todo title">
                        @if (todoForm.get('title')?.touched && todoForm.get('title')?.errors) {
                        <p class="text-red-500 text-xs mt-1">
                            @if (todoForm.get('title')?.errors?.['required']) {
                            Title is required
                            }
                            @if (todoForm.get('title')?.errors?.['minlength']) {
                            Title must be at least 3 characters
                            }
                        </p>
                        }
                    </div>

                    <!-- Description Field -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                        <textarea formControlName="description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm 
                                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Enter description (optional)"></textarea>
                    </div>

                    <!-- Status Field -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Status *</label>
                        <select formControlName="status" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm 
                                focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Select status</option>
                            <option value="pending">Pending</option>
                            <option value="inProgress">In Progress</option>
                            <option value="completed">Completed</option>
                        </select>
                        @if (todoForm.get('status')?.touched && todoForm.get('status')?.errors?.['required']) {
                        <p class="text-red-500 text-xs mt-1">Status is required</p>
                        }
                    </div>

                    <!-- Priority Field -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Priority *</label>
                        <select formControlName="priority" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm 
                                focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Select priority</option>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                        @if (todoForm.get('priority')?.touched && todoForm.get('priority')?.errors?.['required']) {
                        <p class="text-red-500 text-xs mt-1">Priority is required</p>
                        }
                    </div>

                    <!-- Due Date Field -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Due Date *</label>
                        <input type="date" formControlName="due_date" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm 
                               focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        @if (todoForm.get('due_date')?.touched && todoForm.get('due_date')?.errors?.['required']) {
                        <p class="text-red-500 text-xs mt-1">Due date is required</p>
                        }
                    </div>

                    <!-- Form Buttons -->
                    <div class="flex gap-3">
                        <button type="submit" [disabled]="todoForm.invalid" class="flex-1 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 
                                text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                            Add Todo
                        </button>
                        <button type="button" (click)="closeTodoForm()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-medium 
                                py-2 px-4 rounded-lg transition-colors duration-200">
                            Cancel
                        </button>
                    </div>
                </form>


            </div>
        </div>
        }

        <div class="mt-38 w-1/2   ">
            @for (todo of todoItem() | searchPipe : searchTerm(); track $index) {
            <app-todo-item-com [todo]='todo' (todoEdited)="handleTodoEdit($event)"
                (todoDeleted)="handleTodoDelete($event)" (editRequested)="handleEditRequest($event)" />
            }
        </div>

    </div>
</div>